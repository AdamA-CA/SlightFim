WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.refinedwiki.confluence.plugins.theme.original:78', location = 'usercategories-controller.b70ceba8897c155e605b.js' */
(window.webpackJsonpRefinedConfluenceWebPack=window.webpackJsonpRefinedConfluenceWebPack||[]).push([[78],{309:function(e,t,r){"use strict";r.r(t),r.d(t,"UserCategoryController",(function(){return y}));var o=r(0),n=r.n(o),a=r(2),s=r(34),c=r(121),i=r(173),l=r(14);const y={initCategoryMenu(){const e=new c.UserCategoryCollection;e.fetch({data:{type:"category"},success(){s.a.userCategories=e,RWJS.PubSub.trigger("user-categories:fetched")}})},initCategoriesMacro(e){a.default.each(e,(function(e){const t=n()(".rw_user_category_macro_params",n()(e)).data(),r=new c.UserCategoryModel({key:String(t.categoryKey),type:"category",rolesOnly:t.rolesOnly}),o={type:r.get("type"),rolesOnly:t.rolesOnly,"max-results":t.maxResults};void 0!==t.hierarchy&&"no_hierarchy"!==t.hierarchy&&(o.recursive=!0),n()(e).html(RWJS.Templates.Utils.loader({size:"medium"})),void 0!==r.get("key")?r.fetch({data:o,success(){const o=new i.UserCategoryMacroView({model:r,macroParam:t});n()(e).html(o.render()),Confluence.Binder.userHover()},error(t,r){401===r.status?n()(e).html(l.infoBox({content:"The content of this macro can only be viewed by users who have logged in."})):404===r.status?n()(e).html(l.warningBox({content:"Category not found."})):n()(e).html(l.warningBox({content:"An unexpected error has occurred. We apologize for this inconvenience."}))}}):n()(e).html(l.infoBox({content:"Please specify a category key."}))}))},initSpaceMacro(e){a.default.each(e,(function(e){const t=n()(".rw_users_space_macro_params",n()(e)).data();if(!0===t.shouldDisplay){let r;r=t.usersFromCategory?new c.UserCategoryModel({key:String(t.usersFromCategory),type:"category",rolesOnly:t.rolesOnly}):new c.UserCategoryModel({key:String(t.spaceKey),type:"space",rolesOnly:t.rolesOnly}),n()(e).html(RWJS.Templates.Utils.loader({size:"medium"})),n()(e).show(),r.fetch({data:{type:r.get("type"),rolesOnly:t.rolesOnly,displayAdmins:t.displayAdmins,"max-results":t.maxResults},success(){const o=new i.UserSpaceMacroView({model:r,macroParam:t});n()(e).html(o.render()),t.canEdit||r.get("userSize")>0?n()(e).show():n()(e).remove(),Confluence.Binder.userHover()},error(t,r){n()(e).show(),401===r.status?n()(e).html(l.infoBox({content:"The content of this macro can only be viewed by users who have logged in."})):404===r.status?n()(e).html(l.errorBox({content:"Space not found."})):n()(e).html(l.warningBox({content:"An unexpected error has occurred. We apologize for this inconvenience."}))}})}}))},initEditCategoryButton(e){e.click((function(){return s.a.createUserCategoryDialog(window.RW._categoryKey,"category",!1),!1}))},initEditSpaceButton(e){e.click((function(e){const t=n()(e.currentTarget);return s.a.createUserCategoryDialog(t.data("spaceKey"),"space",!0),!1}))}}}}]);
}catch(e){WRMCB(e)};