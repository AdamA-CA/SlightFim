mxEmbedUtils={sha1:function(v){if(!v){return null}var a;try{var p=require("crypto");var b=p.createHash("sha1");b.update(v);a=b.digest("hex")}catch(z){a=undefined}if(a!==undefined){return a}var f=function(j,i){var e=(j<<i)|(j>>>(32-i));return e};var d=function(B){var A="";var j;var e;for(j=7;j>=0;j--){e=(B>>>(j*4))&15;A+=e.toString(16)}return A};var k;var y,w;var c=new Array(80);var n=1732584193;var m=4023233417;var l=2562383102;var h=271733878;var g=3285377520;var u,s,r,q,o;var F;v=unescape(encodeURIComponent(v));var x=v.length;var t=[];for(y=0;y<x-3;y+=4){w=v.charCodeAt(y)<<24|v.charCodeAt(y+1)<<16|v.charCodeAt(y+2)<<8|v.charCodeAt(y+3);t.push(w)}switch(x%4){case 0:y=2147483648;break;case 1:y=v.charCodeAt(x-1)<<24|8388608;break;case 2:y=v.charCodeAt(x-2)<<24|v.charCodeAt(x-1)<<16|32768;break;case 3:y=v.charCodeAt(x-3)<<24|v.charCodeAt(x-2)<<16|v.charCodeAt(x-1)<<8|128;break}t.push(y);while((t.length%16)!==14){t.push(0)}t.push(x>>>29);t.push((x<<3)&4294967295);for(k=0;k<t.length;k+=16){for(y=0;y<16;y++){c[y]=t[k+y]}for(y=16;y<=79;y++){c[y]=f(c[y-3]^c[y-8]^c[y-14]^c[y-16],1)}u=n;s=m;r=l;q=h;o=g;for(y=0;y<=19;y++){F=(f(u,5)+((s&r)|(~s&q))+o+c[y]+1518500249)&4294967295;o=q;q=r;r=f(s,30);s=u;u=F}for(y=20;y<=39;y++){F=(f(u,5)+(s^r^q)+o+c[y]+1859775393)&4294967295;o=q;q=r;r=f(s,30);s=u;u=F}for(y=40;y<=59;y++){F=(f(u,5)+((s&r)|(s&q)|(r&q))+o+c[y]+2400959708)&4294967295;o=q;q=r;r=f(s,30);s=u;u=F}for(y=60;y<=79;y++){F=(f(u,5)+(s^r^q)+o+c[y]+3395469782)&4294967295;o=q;q=r;r=f(s,30);s=u;u=F}n=(n+u)&4294967295;m=(m+s)&4294967295;l=(l+r)&4294967295;h=(h+q)&4294967295;g=(g+o)&4294967295}F=d(n)+d(m)+d(l)+d(h)+d(g);return F.toLowerCase()},b64toBlob:function(m,l,c,j){l=l||"";c=c||512;var f=j?m:atob(m);var h=[];for(var d=0;d<f.length;d+=c){var k=f.slice(d,d+c);var g=new Array(k.length);for(var e=0;e<k.length;e++){g[e]=k.charCodeAt(e)}var b=new Uint8Array(g);h.push(b)}var a=new Blob(h,{type:l});return a},saveAtt:function(e,h,c,b,g,f,m,j,a,l){var k=new FormData();var i=(h instanceof Blob)?h:new Blob([h],{type:b});k.append("file",i,c);k.append("minorEdit",!g);var d=a?"?status=draft":"";if(f!=null){k.append("comment",f)}$.ajax({type:"POST",data:k,url:AJS.contextPath()+"/rest/api/content/"+e+"/child/attachment"+(l?"/"+l+"/data":"")+d,contentType:false,processData:false,mimeType:"multipart/form-data",headers:{"X-Atlassian-Token":"nocheck"},success:m,error:j})},getAttachmentsList:function(c,i,h,g){var a=0,d=200;var e=[],f={};function b(){$.ajax({type:"GET",url:AJS.contextPath()+"/rest/api/content/"+c+"/child/attachment?start="+a+"&limit="+d,contentType:"application/json;charset=UTF-8",success:function(k){for(var j=0;j<k.results.length;j++){if(g){f[k.results[j].title.toLowerCase()]=k.results[j]}else{e.push({id:k.results[j].id,title:k.results[j].title})}}if(k._links&&k._links.next){a+=k.limit;b()}else{i(g?f:e)}},error:h})}b()},getUniqueName:function(c,a){var b=a;var d=1;while(c[a.toLowerCase()]){a=d+"-"+b;d++}return a},getViewerAspect:function(g){if(g.diagrams&&g.diagrams[g.currentPage]){var f=[],b=g.diagrams[g.currentPage].getAttribute("id");var c=g.graph.getModel();var a=c.getChildCount(c.root);for(var e=0;e<a;e++){var d=c.getChildAt(c.root,e);if(c.isVisible(d)){f.push(d.id)}}return b+" "+f.join(" ")}return null},getViewImage:function(e,f,d){function b(){f(c)}var c={};if(!d){c.aspect=mxEmbedUtils.getViewerAspect(e)}var a=e.graph.view.graphBounds;c.width=Math.round(a.width)||null;if(e.editor.isExportToCanvas()){e.editor.exportToCanvas(function(g){var h=g.toDataURL("image/png");c.image=h.substring(h.lastIndexOf(",")+1);f(c)},null,null,null,b)}else{b()}},importCsv:function(a,d,c){EditorUi.prototype.createUi=function(){};EditorUi.prototype.addTrees=function(){};EditorUi.prototype.updateActionStates=function(){};EditorUi.prototype.onBeforeUnload=function(){};var b=new EditorUi();b.handleError=c;b.importCsv(a,function(){var e=b.editor.getGraphXml();d(e,mxUtils.getXml(e))})},initI18nAsync:function(c,d,b){RESOURCE_BASE=(b||AJS.contextPath()+"/download/resources/com.mxgraph.confluence.plugins.diagramly:drawio-editor")+"/resources/dia";mxLanguage=c;mxResources.loadDefaultBundle=false;var a=mxResources.getDefaultBundle(RESOURCE_BASE,c)||mxResources.getSpecialBundle(RESOURCE_BASE,c);mxUtils.getAll([a],function(e){mxResources.parse(e[0].getText());if(d){d()}})},applyTranslation:function(e){var b=e.querySelectorAll("*[data-i18n]");for(var d=0;d<b.length;d++){var a=b[d].getAttribute("data-i18n");b[d].innerHTML=mxUtils.htmlEntities(mxResources.get(a,null,b[d].innerHTML))}var f=e.querySelectorAll("*[data-i18n-title]");for(var d=0;d<f.length;d++){var a=f[d].getAttribute("data-i18n-title");f[d].setAttribute("title",mxUtils.htmlEntities(mxResources.get(a,null,f[d].getAttribute("title"))))}var c=e.querySelectorAll("*[data-i18n-placeholder]");for(var d=0;d<c.length;d++){var a=c[d].getAttribute("data-i18n-placeholder");c[d].setAttribute("placeholder",mxUtils.htmlEntities(mxResources.get(a,null,c[d].getAttribute("placeholder"))))}}};